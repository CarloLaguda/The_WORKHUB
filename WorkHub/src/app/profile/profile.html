<div>
    <button (click)="startLogout()">LOGOUT</button>
</div>
<div class="container">
    <div class="center">
        <div class="info">
            <div class="basicInfo">
                <div class="profileImage"></div>
                <h1>{{user?.first_name}} {{user?.last_name}}</h1>
                <h3>{{user?.username}}</h3>
            </div>
            <div class="separation"></div>
            <div class="otherInfo">
                <div class="editInfo">
                    <h3>Country: {{user?.country}}</h3>
                    <div class="email-edit">
                        <div class="email-edit">
                            @if (tCountry) {
                                <input type="text" placeholder="Inseerisci paese" #country>
                                <button (click)="updateUser('country', country.value)">Aggiorna</button>
                                <button class="editBtn" (click)="toggleCountry()">Chiudi</button>
                            } @else {
                                <button class="editBtn" (click)="toggleCountry()">Edit</button>
                            }
                        </div>
                    </div>
                </div>
                <div class="editInfo">
                    <h3>Status: {{user?.status}}</h3>
                    <div class="email-edit">
                        @if (tStatus) {
                            <select [(ngModel)]="selectedStatus">
                                <option value="">Il tuo status</option>
                                <option value="libero">Libero</option>
                                <option value="occupato">Occupato</option>
                            </select>
                            <button (click)="updateUser('status', selectedStatus)">Aggiorna</button>
                            <button class="editBtn" (click)="toggleStatus()">Chiudi</button>
                        } @else {
                            <button class="editBtn" (click)="toggleStatus()">Edit</button>
                        }
                    </div>
                </div>
                <div class="editInfo">
                   <h3>Anni di esperienza: {{user?.anni_di_esperienza}}</h3>
                    <div class="email-edit">
                        @if (tAnnixp) {
                            <input type="number" placeholder="Inseerisci anni" #annixp>
                            <button (click)="updateUser('anni_di_esperienza', annixp.value)">Aggiorna</button>
                            <button class="editBtn" (click)="toggleAnniexp()">Chiudi</button>
                        } @else {
                            <button class="editBtn" (click)="toggleAnniexp()">Edit</button>
                        }
                    </div>
                </div>
            </div>
            <div class="separation"></div>
            <div class="statusInfo">
                <div class="editInfo">
                    <h3>Username: {{user?.username}}</h3>
                    <div class="email-edit">
                        @if (tUser) {
                            <input type="text" placeholder="Nuovo username" #nuovaUser>
                            <button (click)="updateUser('username', nuovaUser.value)">Aggiorna</button>
                            <button class="editBtn" (click)="toggleUsername()">Chiudi</button>
                        } @else {
                            <button class="editBtn" (click)="toggleUsername()">Edit</button>
                        }
                    </div>
                </div>
                <div class="editInfo">
                    <h3>Email: {{user?.email}}</h3>
                    <div class="email-edit">
                        @if (tMail) {
                            <input type="email" placeholder="Nuova email" #nuovaMail>
                            <button (click)="updateUser('email', nuovaMail.value)">Aggiorna</button>
                            <button class="editBtn" (click)="toggleMail()">Chiudi</button>
                        } @else {
                            <button class="editBtn" (click)="toggleMail()">Edit</button>
                        }
                    </div>
                </div>
                <div class="editInfo">
                    <h3>Password: <p>La tua password non viene mostrata per privacy</p></h3>
                    <div class="email-edit">
                        @if (tPass) {
                            <input 
                                [type]="showPassword ? 'text' : 'password'" 
                                placeholder="password" 
                                #nuovapassword>
                            <button (click)="togglePasswordText()">
                                @if (showPassword) {
                                    nascondi
                                }@else {
                                    mostra
                                }
                            </button>
                            <button (click)="updateUser('password', nuovapassword.value)">Aggiorna</button>
                            <button class="editBtn" (click)="togglePass()">Chiudi</button>
                        } @else {
                            <button class="editBtn" (click)="togglePass()">Edit</button>
                        }
                    </div>
                </div>
                <hr>
                <div class="editInfo" routerLink="/users">
                    <button>Visualizza gli altri utenti</button>
                </div>
                <br>
                <div class="editInfo" routerLink="/projects">
                    <button>Visualizza i progetti</button>
                </div>
            </div>
        </div>
        <div class="info2">
            <div class="skillSet">
                <h2>Skill</h2>
                <select [(ngModel)]="Skill">
                    <option value=""></option>
                    @for (skill of skills; track skill) {
                        <option [value]="skill">{{ skill }}</option>
                    }
                </select>
                <p>Le tue skils: {{user?.skills}}</p>
            </div>
            <button (click) = "addUserSkill('skill_names')">Aggiungi alle tue skill</button>
            <div class="progetti">
                <h2>Progetti</h2>
                @if(progetti.length === 0){
                    <div>Non partecipi a nessun progetto</div>
                }@else {
                    @for(pro of progetti; track pro){
                        <div class="prova">{{pro.title}}</div>
                    }
                }
            </div>
            <button routerLink="/createProject">Crea il tuo progetto</button>
        </div>
    </div>
</div>