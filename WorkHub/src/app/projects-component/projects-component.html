
<div class="filters-projects">
  <label>
    Skill richiesta:
    <select [(ngModel)]="filterProjectSkill">
      <option value="">-- Tutte le skill --</option>
      @for(skill of skillsList; track skill) {
        <option [value]="skill">{{ skill }}</option>
      }
    </select>
  </label>

  <label>
    Ambiti
    <select [(ngModel)]="filterProjectEnv">
      <option value="">-- Tutte gli ambiti --</option>
      @for(env of envList; track env) {
        <option [value]="env">{{ env }}</option>
      }
    </select>
  </label>

  <label>
    Disponibilit√†:
    <select [(ngModel)]="filterProjectAvailability">
      <option value="full">Full</option>
      <option value="open">Open</option>
    </select>
  </label>

  <button (click)="applyProjectFilters()">Filtra progetti</button>
  <button (click)="clearProjectFilters()">Reset progetti</button>
</div>
<div>
  <div> Nome Utente {{user?.first_name}} {{user?.last_name}}</div>
  <div>Torna alla tua pagina privata
    <button routerLink="/profile">Profilo</button>
  </div>
</div>
<hr />

<!-- üîπ Lista progetti filtrata -->
@if (projects | async; as projects) {
  <div>
    @for (pro of projects; track pro) {
      <!-- Applica filtro skill e availability -->
        <div class="project-card">
          <h1>{{ pro.title }}</h1>
          <p>Numero di persone: {{ pro.user_count }}</p>
          @if(!pro.is_full){
            <button (click) = "add_userProject(pro.project_id)">Unisciti al Proggetto</button>
          }
          <!-- Toggle dettagli progetto -->
          <button (click)="toggleProjectDetails(pro.project_id)">
            {{ expandedProjectId === pro.project_id ? 'Nascondi dettagli' : 'Scopri di pi√π' }}
          </button>

          @if (expandedProjectId === pro.project_id) {
            <div class="details">
              <p>Skill richieste: {{ pro.required_skills }}</p>
              <p>Ambito: {{pro.environments}}</p>
              <p>Disponibilit√†: {{ pro.availability }}</p>
              <p>Descrizione: {{ pro.description }}</p>
            </div>
          }
        </div>
        <br>
      }
  </div>
}@else {
  <p>Caricamento in corso...</p>
}

<div class="popup-overlay"
     *ngIf="popupVisible && popupType === 'success'">
  <div class="popup" (click)="$event.stopPropagation()">
    <h2>‚úÖTi sei unito ad un progetto</h2>
    <p>{{popupMessage}}</p>
    <button (click)="closePopup()">Close</button>
  </div>
</div>

<!-- ‚ùå POPUP ERRORE -->
<div class="popup-overlay"
     *ngIf="popupVisible && popupType === 'error'"
     (click)="closePopup()">
  <div class="popup" (click)="$event.stopPropagation()">
    <h2>‚ö†Ô∏èNon sei riuscito ad unirti ad un progetto</h2>
    <p>{{ popupMessage }}</p>
    <button (click)="closePopup()">Close</button>
  </div>
</div>
